<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Group Randomizer</title>
    <style>
        body {
            background-color: #1e1e1e;
            color: #ffffff;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        h1 {
            color: #c9a0dc;
        }
        .table-container {
            width: 30%;
            margin: 20px;
            display: inline-block;
            vertical-align: top;
        }
        table {
            width: 100%;
            background-color: #2e2e2e;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        th, td {
            border: 1px solid #444444;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #3e3e3e;
            color: #c9a0dc;
        }
        textarea {
            width: calc(100% - 12px);
            background-color: #3e3e3e;
            border: 1px solid #555555;
            color: #ffffff;
            padding: 5px;
            margin-top: 5px;
            resize: vertical;
        }
        button {
            background-color: #c9a0dc;
            border: none;
            color: #1e1e1e;
            padding: 8px 16px;
            margin-top: 5px;
            cursor: pointer;
        }
        .button-full-width {
            width: 100%;
        }
        #groups-container {
            width: 80%;
            margin: 30px auto 20px;
            text-align: center;
        }
        .groupTable {
            width: 100%;
            background-color: #2e2e2e;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .groupTable th, .groupTable td {
            border: 1px solid #444444;
            padding: 8px;
            text-align: center;
        }
        .groupTable th {
            background-color: #3e3e3e;
            color: #c9a0dc;
        }
    </style>
</head>
<body>
    <h1>Group Randomizer</h1>

    <div>
        <div class="table-container">
            <table id="tankTable">
                <thead>
                    <tr><th>Tank</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <textarea id="tankInput" placeholder="Paste Tank Names (one per line)" rows="5"></textarea>
            <button class="button-full-width" onclick="addPlayers('tank')">Add Tanks</button>
        </div>

        <div class="table-container">
            <table id="dpsTable">
                <thead>
                    <tr><th>DPS</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <textarea id="dpsInput" placeholder="Paste DPS Names (one per line)" rows="5"></textarea>
            <button class="button-full-width" onclick="addPlayers('dps')">Add DPS</button>
        </div>

        <div class="table-container">
            <table id="healerTable">
                <thead>
                    <tr><th>Healer</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <textarea id="healerInput" placeholder="Paste Healer Names (one per line)" rows="5"></textarea>
            <button class="button-full-width" onclick="addPlayers('healer')">Add Healers</button>
        </div>
    </div>

    <div>
        <button onclick="generateGroups()">Generate Groups</button>
    </div>

    <div id="groups-container">
        <!-- Generated groups will be displayed here -->
    </div>

    <script>
        var tanks = [];
        var dpsList = [];
        var healers = [];

        function addPlayers(role) {
            var inputId = role + 'Input';
            var tableId = role + 'Table';
            var playerNames = document.getElementById(inputId).value.trim();

            if (playerNames !== '') {
                var namesArray = playerNames.split('\n');
                var tableBody = document.getElementById(tableId).getElementsByTagName('tbody')[0];

                namesArray.forEach(function(playerName) {
                    playerName = playerName.trim();
                    if (playerName !== '') {
                        var newRow = tableBody.insertRow();
                        var newCell = newRow.insertCell(0);
                        newCell.textContent = playerName;

                        if (role === 'tank') {
                            tanks.push(playerName);
                        } else if (role === 'dps') {
                            dpsList.push(playerName);
                        } else if (role === 'healer') {
                            healers.push(playerName);
                        }
                    }
                });

                document.getElementById(inputId).value = '';
            }
        }

        function generateGroups() {
            var groupsContainer = document.getElementById('groups-container');
            groupsContainer.innerHTML = '';

            var numGroups = Math.min(
                Math.floor(tanks.length / 1),
                Math.floor(dpsList.length / 3),
                Math.floor(healers.length / 1)
            );

            if (numGroups < 1) {
                alert('Not enough players to generate any groups.');
                return;
            }

            for (var i = 0; i < numGroups; i++) {
                var selectedTank = tanks.splice(Math.floor(Math.random() * tanks.length), 1)[0];
                var selectedHealer = healers.splice(Math.floor(Math.random() * healers.length), 1)[0];

                var selectedDPS = [];
                for (var j = 0; j < 3; j++) {
                    var dpsIndex = Math.floor(Math.random() * dpsList.length);
                    selectedDPS.push(dpsList.splice(dpsIndex, 1)[0]);
                }

                removePlayerFromTable('tankTable', selectedTank);
                removePlayerFromTable('healerTable', selectedHealer);
                selectedDPS.forEach(function(dps) {
                    removePlayerFromTable('dpsTable', dps);
                });

                var groupTable = document.createElement('table');
                groupTable.className = 'groupTable';

                var thead = document.createElement('thead');
                var headerRow = document.createElement('tr');
                var roles = ['Tank', 'DPS 1', 'DPS 2', 'DPS 3', 'Healer'];
                roles.forEach(function(role) {
                    var th = document.createElement('th');
                    th.textContent = role;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                groupTable.appendChild(thead);

                var tbody = document.createElement('tbody');
                var dataRow = document.createElement('tr');
                [selectedTank].concat(selectedDPS).concat([selectedHealer]).forEach(function(name) {
                    var td = document.createElement('td');
                    td.textContent = name;
                    dataRow.appendChild(td);
                });
                tbody.appendChild(dataRow);
                groupTable.appendChild(tbody);

                groupsContainer.appendChild(groupTable);
            }
        }

        function removePlayerFromTable(tableId, playerName) {
            var table = document.getElementById(tableId);
            var tbody = table.getElementsByTagName('tbody')[0];
            var rows = tbody.getElementsByTagName('tr');

            for (var i = rows.length - 1; i >= 0; i--) {
                var cellText = rows[i].cells[0].textContent;
                if (cellText === playerName) {
                    tbody.deleteRow(i);
                    break;
                }
            }
        }
    </script>
</body>
</html>
